feed_uri: http://assets.axoom.cloud/mixins/axoom-identity-client.xml
name: AXOOM Service Mixin
summary: Adds config for clients of the Identity Server
description: This mixin adds config for clients of the Identity Server: Sets IDENTITY_SERVER_URI environment variable and enforces the export of IDENTITY_CLIENTS

mixin_parameters:
  - SERVICE_NAME
  - IDENTITY_CLIENT

external_environment:
  required:
    - PUBLIC_DOMAIN
    - PROTOCOL
  optional:
    - SUBDOMAIN_SERVICE_NAME_SEPARATOR

exported_environment:
  IDENTITY_CLIENTS: (IDENTITY_CLIENT)

compose:
  - version: '3.2'
    services:
      (SERVICE_NAME):
        environment:
          IDENTITY_SERVER_URI: ${PROTOCOL}://identity${SUBDOMAIN_SERVICE_NAME_SEPARATOR-.}${PUBLIC_DOMAIN}
