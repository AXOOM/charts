digraph {
	graph [fontname=Arial]
    node [shape=box]
    rankdir = LR;

    subgraph cluster_templates {
        label="'dotnet new' templates";
        style=dotted;

        axxom_service_t [label="axoom-service", style=dotted];
        axoom_webservice_t [label="axoom-webservice", style=dotted];
        axoom_portal_app_t [label="axoom-portal-app", style=dotted];
    }

    subgraph cluster_assets {
        label="assets.axoom.cloud";

        subgraph cluster_mixins {
            label="mixins";

            postgres [label="postgres.xml", style=dotted];

            backup_service [label="backup-service.xml"];
            expose_ssh_jump [label="expose-ssh-jump.xml"];
            expose_internal [label="expose-internal.xml"];
            expose_public [label="expose-public.xml"];
            axoom_service [label="axoom-service.xml"];
            axoom_portal_app [label="axoom-portal-app.xml"];
        }

        subgraph cluster_networks {
            label="networks";

            backup [label="backup.xml"];
            ssh_jump [label="ssh-jump.xml"];
            traefik_internal [label="traefik-internal.xml"];
            traefik_public [label="traefik-public.xml"];

        }

        subgraph cluster_services {
            label="services";
            style=dotted;

            portal [label="portal.xml", style=dotted];
            identity [label="identity.xml", style=dotted];
        }
    }

    expose_internal -> traefik_internal;
    axoom_portal_app -> expose_public -> traefik_public;
    axoom_portal_app -> portal;
    backup_service -> backup;
    expose_ssh_jump -> ssh_jump;
    
    {axxom_service_t axoom_webservice_t} -> axoom_service [style=dotted];
    axoom_webservice_t -> expose_internal [style=dotted];
    axoom_portal_app_t -> axoom_portal_app [style=dotted];
    portal -> identity [style=dotted];
    postgres -> {backup_service expose_ssh_jump} [style=dotted];
}
